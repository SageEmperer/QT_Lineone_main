{% extends 'base/base.html' %}
{% block title %}QTLineone | Lesson Title{% endblock %}
{% block breadCrum %}

<!-- Breadcrumb -->
<div class="hk-pg-header d-flex justify-content-between mb-0">
  <h4 class="hk-pg-title m-3">Lesson Title</h4>
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb bg-transparent mb-0">
      <li class="breadcrumb-item"><a href="{% url 'dashboard' %}">Dashboard</a></li>
      <li class="breadcrumb-item"><a href="{% url 'settings' %}">Settings</a></li>
      <li class="breadcrumb-item active" aria-current="page">Lesson Title</li>
    </ol>
  </nav>
</div>
<!-- /Breadcrumb -->
{% endblock %}
{% block content %}
 <!-- message here -->

 {% if messages %}
 {% for message in messages %}
   {% if message.tags == "error" %}
     <div class="h-25 alert alert-danger alert-dismissible fade show mt-2 h-25 text-center" role="alert">{{ message }}</div>
   {% elif message.tags == "success" %}
     <div class="h-25 alert alert-success alert-dismissible fade show mt-2 h-25 text-center" role="alert">{{ message }}</div>
     {% else %}
    <div class="h-25 alert alert-info alert-dismissible fade show mt-2 h-25 text-center" role="alert">{{ message }}</div>
    {% endif %}
   {% endfor %}
 {% endif %}

<!-- message end here -->
<section class="hk-sec-wrapper">
  <div class="d-flex justify-content-between">

    <div class="">
      <button type="button" class="btn btn-primary mr-2 mb-3" data-toggle="modal" data-target="#CreateSpecialization">
        <i class="glyphicon glyphicon-plus"></i> Create Lesson
      </button>
      <a href="{% url 'specialization_export' %}" class="btn btn-success mr-2 mb-3"><i class="glyphicon glyphicon-export"></i> Export</a>
      <button type="button" class="btn btn-secondary mr-2 mb-3" data-toggle="modal" data-target="#UploadSpecialization">
        <i class="glyphicon glyphicon-import"></i> Import
      </button>
    </div>
    <div class="">
      <button type="button" class="btn btn-danger mr-2 mb-3" id="deleteButton" data-toggle="modal"
        data-target="#deleteModal" style="display: none; position: relative; top: 0px; ">
        <i class="glyphicon glyphicon-trash"></i> Delete
    </button>
    </div>
  </div>

  <div class="row">
    <div class="col-sm">
      <div class="table-wrap">
        <table id="datable_1" class="table table-hover w-100 display pb-30 table-bordered">
          <thead class="bg-dark">
            <tr>
              <th class="text-white text-center"><input type="checkbox" id="selectAll"> All</th>

              <th class="text-white">S.No</th>
              <th class="text-white">Sub Category</th>
              <th class="text-white">Course Name</th>
              <th class="text-white">Specialization</th>
              <th class="text-white">Chapter</th>
              <th class="text-white">Lesson Title</th>
              <th class="text-white text-center">Status</th>
              <th class="text-white text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for lesson in lessons %}  
            <tr>
              <td class="text-center"><input type="checkbox" class="row-checkbox" data-course-id=""
                data-course-name=""></td>
            </td>
              <td >{{forloop.counter}}</td>
              <td >{{lesson.sub_cat_title.sub_cat_title}}</td>
              <td>{{lesson.course_title.course_name}}</td>  
              <td>{{lesson.spec_title.specilalization_name}}</td>
              <td >{{lesson.chapter_title.chapter_title}}</td>
              <td>{{lesson.lesson_title}}</td>
              <td class="text-center ">
                {% if lesson.lesson_status %}
                <a href="{% url 'lesson_status' lesson.id %}" class="btn btn-success badge text-bg-light rounded-pill">Active</a>
                {% else %}
                <a href="{% url 'lesson_status' lesson.id %}" class="btn btn-danger badge text-bg-light rounded-pill">Deactive</a>

                {% endif %}
              </td>
              <td class="text-center ">
                <button class="btn btn-primary m-1" data-toggle="modal" data-target="#lesson_edit_model{{forloop.counter}}">
                  <i class="fa fa-pencil"></i>
                </button>
                <button class="btn btn-danger m-1" data-toggle="modal" data-target="#delete_lesson_model{{forloop.counter}}">
                  <i class="fa fa-trash"></i>
                </button>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>

<!-- create model start here -->

<div class="modal fade" id="CreateSpecialization" tabindex="-1" role="dialog" aria-labelledby="CreateSpecialization"
  aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header bg-dark">
        <h5 class="modal-title text-white">Create Lesson</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="text-white">&times;</span>
        </button>
      </div>
      <form action="{% url 'lesson_title' %}" method="post" id="lesson_create_form" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="modal-body modal-lg">
          <div class="row">
            <div class="mb-3 col-6">
                <label>Chapter <span class="text-danger">*</span></label>
                <select class="form-control custom-select chapter-select" name="chapter_name">
                  <option selected value="">Select your chapter</option>
                  {% for chapter in chapters %}
                  <option value="{{chapter.id}}">{{chapter.chapter_title}}</option>
                  {% endfor %}
                </select>
              </div>
              <div class="mb-3 col-6">
                  <label>Specialization <span class="text-danger">*</span></label>
                  <select class="form-control custom-select specialization-select" name="specialization_name">
                    <!-- <option selected value="">Select your Specialization</option>
                    {% for spc in specializations %}
                    <option  value="{{spc.id}}">{{spc.specilalization_name}}</option>
                    {% endfor %} -->
                    
                  </select>
                </div>
              </div>
            
            <div class="row">
              <div class="mb-3 col-6">
                <label>Course Name <span class="text-danger">*</span></label>
                <select class="form-control custom-select course-select" name="course_name">
                  <!-- <option value="" selected>Select your Course</option>
                  {% for course in courses %}
                  <option  value="{{course.id}}">{{course.course_name}}</option>
                  {% endfor %} -->
                  
                </select>
              </div>
              <div class="mb-3 col-6">
                <label>Sub Category  <span class="text-danger">*</span></label>
                <select class="form-control custom-select sub-category-select" name="sub_category_name">
                  <!-- <option selected value="">Select Sub Category</option>
                  {% for sub in sub_categories %}
                  <option  value="{{sub.id}}">{{sub.sub_cat_title}}</option>
                  {% endfor %} -->
                  
                </select>
              </div>
              </div>
              
              <div class="row">
                
                <div class="mb-3 col-12">
                    <label for="">Lesson Title <span class="text-danger">*</span></label>
                      <input  type="text" class="form-control" id="lesson_title" name="lesson_title"
                        placeholder="Ex: Core Python, Django" aria-describedby="inputGroupPrepend" required />
                  </div>
              </div>
          
            
          
          
          
          <div class="row ">
            <div class="mb-3 col-6">
                
                    <label>Lesson Logo (PNG/JPG /Size:-200X200) <b style="color: red;">*</b>
                    </label>

                    <div class="fileinput fileinput-new input-group" data-provides="fileinput">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Upload</span>
                        </div>
                        <div class="form-control text-truncate" data-trigger="fileinput"><i class="glyphicon glyphicon-file fileinput-exists"></i> <span class="fileinput-filename"></span></div>
                        <span class="input-group-append">
                                <span class=" btn btn-primary btn-file"><span class="fileinput-new">Select file</span><span class="fileinput-exists">Change</span>
                                                    
                    <input aria-describedby="inputGroupFileAddon03" aria-label="Upload" 
                    accept="image/png, image/jpg, image/jpeg" name="lesson_logo" type="file">
                        </span>
                        <a href="#" class="btn btn-secondary fileinput-exists" data-dismiss="fileinput">Remove</a>
                        </span>
                    </div>
                   
            </div>
            <div class="mb-3 col-6">
               
                    <label> Lesson Image (PNG/JPG /Size:-800X533) <b style="color: red;">*</b>
                    </label>
                    <div class="fileinput fileinput-new input-group" data-provides="fileinput">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Upload</span>
                        </div>
                        <div class="form-control text-truncate" data-trigger="fileinput"><i class="glyphicon glyphicon-file fileinput-exists"></i> <span class="fileinput-filename"></span></div>
                        <span class="input-group-append">
                                <span class=" btn btn-primary btn-file"><span class="fileinput-new">Select file</span><span class="fileinput-exists">Change</span>
                                <input aria-describedby="inputGroupFileAddon03" aria-label="Upload" 
                                name="lesson_image" accept="image/png, image/jpg, image/jpeg" type="file">
                        </span>
                        <a href="#" class="btn btn-secondary fileinput-exists" data-dismiss="fileinput">Remove</a>
                        </span>
                    </div>
                    
             
            </div>
        </div>
    
            <div class="mb-3 ml-1 mr-1">
                <label class="form-label">Lesson Short Description <b style="color: red;">*</b>
                </label>
                <textarea class="form-control" name="short_description"
                          placeholder="Enter lesson short Description" rows="3"></textarea>
            </div>
        </div>  
        <div class="mb-3 d-flex justify-content-center">
          <button type="submit" class="btn btn-primary m-1">Submit</button>
          <button type="reset" class="btn btn-secondary m-1">Reset</button>
        </div>
      </form>
    </div>
  </div>
</div>
<!-- Create model end here -->
<!-- Edit model start here -->

{% for lesson in lessons %}  
<div class="modal fade" id="lesson_edit_model{{forloop.counter}}" tabindex="-1" role="dialog" aria-labelledby="lesson_edit_model"
  aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header bg-dark">
        <h5 class="modal-title text-white">Edit Lesson</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="text-white">&times;</span>
        </button>
      </div>
      <form action="{% url 'lesson_edit' lesson.id %}" method="post" class="lesson_edit_form" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="modal-body modal-lg">
          <div class="row">
            <div class="mb-3 col-6">
              <label>Chapter <span class="text-danger">*</span></label>
              <select class="form-control custom-select chapter-select" name="chapter_name_edit">
                <option selected value="">Select your chapter</option>
                {% for chapter in chapters %}
                <option value="{{chapter.id}}">{{chapter.chapter_title}}</option>
                {% endfor %}
                
              </select>
            </div>
            <div class="mb-3 col-6">
                <label>Specialization <span class="text-danger">*</span></label>
                <select class="form-control custom-select specialization-select"  name="specialization_edit">
                  <!-- <option selected value="">Select your Course</option>
                  {% for course in courses %}
                  <option  value="{{course.id}}">{{course.course_name}}</option>
                  {% endfor %} -->
                  
                </select>
            </div>
        </div>
           
         
          <div class="row">
            <div class="mb-3 col-6">
                <label>Course <span class="text-danger">*</span></label>
                <select class="form-control custom-select  course-select" name="course_name_edit">
                  <!-- <option selected value="">Select your Specialization</option>
                  {% for spc in specializations %}
                  <option  value="{{spc.id}}">{{spc.specilalization_name}}</option>
                  {% endfor %} -->
                  
                </select>
              </div>
            <div class="mb-3 col-6">
              <label>Sub Category  <span class="text-danger">*</span></label>
              <select class="form-control custom-select sub-category-select" name="sub_category_edit">
                <!-- <option selected value="">Select Sub Category</option>
                {% for sub in sub_categories %}
                <option  value="{{sub.id}}">{{sub.sub_cat_title}}</option>
                {% endfor %} -->
              
              </select>
            </div>
          </div>
              
           
              <div class="row">
            
                <div class="mb-3 col-12">
                    <label for="">Lesson Title <span class="text-danger">*</span></label>
                      <input  type="text" class="form-control" id="lesson_title_edit" name="lesson_title_edit"
                        placeholder="Ex: Core Python, Django" aria-describedby="inputGroupPrepend" required />
                  </div>
              </div>
          
            
          
          
          
          <div class="row ">
            <div class="mb-3 col-6">
                
                    <label>Lesson Logo (PNG/JPG /Size:-200X200) <b style="color: red;">*</b>
                    </label>

                    <div class="fileinput fileinput-new input-group" data-provides="fileinput">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Upload</span>
                        </div>
                        <div class="form-control text-truncate" data-trigger="fileinput"><i class="glyphicon glyphicon-file fileinput-exists"></i> <span class="fileinput-filename"></span></div>
                        <span class="input-group-append">
                                <span class=" btn btn-primary btn-file"><span class="fileinput-new">Replace file</span><span class="fileinput-exists">Change</span>
                                                    
                    <input aria-describedby="inputGroupFileAddon03" aria-label="Upload" 
                    accept="image/png, image/jpg, image/jpeg" name="lesson_logo_edit" type="file">
                        </span>
                        <a href="#" class="btn btn-secondary fileinput-exists" data-dismiss="fileinput">Remove</a>
                        </span>
                    </div>
                   
            </div>
            <div class="mb-3 col-6">
               
                    <label> Lesson Image (PNG/JPG /Size:-800X533) <b style="color: red;">*</b>
                    </label>
                    <div class="fileinput fileinput-new input-group" data-provides="fileinput">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Upload</span>
                        </div>
                        <div class="form-control text-truncate" data-trigger="fileinput"><i class="glyphicon glyphicon-file fileinput-exists"></i> <span class="fileinput-filename"></span></div>
                        <span class="input-group-append">
                                <span class=" btn btn-primary btn-file"><span class="fileinput-new">Replace file</span><span class="fileinput-exists">Change</span>
                                <input aria-describedby="inputGroupFileAddon03" aria-label="Upload" 
                                name="lesson_image_edit" accept="image/png, image/jpg, image/jpeg" type="file">
                        </span>
                        <a href="#" class="btn btn-secondary fileinput-exists" data-dismiss="fileinput">Remove</a>
                        </span>
                    </div>
                    
             
            </div>
        </div>
    
            <div class="mb-3 ml-1 mr-1">
                <label class="form-label">Lesson Short Description <b style="color: red;">*</b>
                </label>
                <textarea class="form-control" name="short_description_edit"
                          placeholder="Enter Lesson Short Description" rows="3"></textarea>
            </div>
        </div>  
        <div class="mb-3 d-flex justify-content-center">
          <button type="submit" class="btn btn-primary m-1">Submit</button>
          <button type="reset" class="btn btn-secondary m-1">Reset</button>
        </div>
      </form>
    </div>
  </div>
</div>

{% endfor %}

<!-- Edit model end here -->

<!-- Delete model start here -->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
          <div class="modal-header bg-danger">
              <h5 class="modal-title text-white " id="deleteModalLabel">Delete Employee Type</h5>
              <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>
          <div class="modal-body">
              <div class="mb-3 text-center">
                  <div class="d-flex justify-content-center mb-3">
                      <img src="../../static/triangle-exclamation-solid.svg" width="120" height="70" alt="">
                  </div>
                  <form action="" method="post">
                      {% csrf_token %}
                      <p id="deleteMessage">Are you sure you want to delete <strong><span id="selectedCount"></span></strong> records?</p>
                      <input type="hidden" id="selected_ids_input" name="selected_ids">
              </div>
              <div class="d-flex justify-content-center">
                <button type="submit" class="btn btn-danger m-1" id="confirmDelete">Yes</button>
                <button type="button" class="btn btn-secondary m-1" data-dismiss="modal">No</button>
              </div>
              </form>
          </div>

      </div>
  </div>
</div>


{% for lesson in lessons %}
<div class="modal fade" id="delete_lesson_model{{forloop.counter}}" tabindex="-1" role="dialog" aria-labelledby="delete_lesson_model"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header bg-danger">
        <h5 class="modal-title text-white">Delete lesson</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="text-white">&times;</span>
        </button>
      </div>
      <form action="{% url 'lesson_delete' lesson.id %}" method="post" class="">
        {% csrf_token %}
        <div class="modal-body">
          <div class="mb-3 text-center">
            <div class="d-flex justify-content-center mb-3">

              <img src="../../static/triangle-exclamation-solid.svg" width="120" height="70" alt="">
            </div>
            Are you sure you want to delete  ({{lesson.lesson_title}}) of  {{lesson.course_title.course_name}} Course ?
          </div>
        </div>
        <div class="mb-3 d-flex justify-content-center">
          <button type="submit" class="btn btn-danger m-1">Yes</button>
          <button type="button" class="btn btn-secondary m-1" data-dismiss="modal" aria-label="Close">
            No
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

{% endfor %}

<!-- Delete model end here -->

<!-- Upload model  -->

<div class="modal fade" id="UploadSpecialization" tabindex="-1" role="dialog" aria-labelledby="UploadSpecialization" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header bg-dark">
        <h5 class="modal-title text-white">Upload File</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="text-whte">&times;</span>
        </button>
      </div>
      <form action="" method="post" id="uploadfile" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="modal-body">
          <input type="file" name="sep_file" accept=".csv" id="input-file-now" class="dropify" />
          <div id="csvPreview"></div>
         </div>
        <div class="mb-3 d-flex justify-content-center">
          <button type="submit" class="btn btn-primary m-1">Submit</button>
          <button type="button" class="btn btn-secondary m-1" data-dismiss="modal" aria-label="Close">
            Close
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Upload model end here -->

{% endblock %}


{% block scripts %}

<script>
  $(document).ready(function () {
   


    $.validator.addMethod("alphanumeric", function(value, element) {
      return this.optional(element) || /^[a-zA-Z0-9\s]+$/.test(value) && !(/^\d+$/.test(value));
  }, "Name should only contain letters and numbers.");

  $.validator.addMethod("noDoubleSpace", function(value, element) {
      return this.optional(element) || !/\s{2}/.test(value);
  }, "Name should not contain double spaces.");

  $.validator.addMethod("address", function(value, element) {
      return this.optional(element) || /^[a-zA-Z0-9\s\.,#-/=_@]+$/.test(value);
  }, "Only address allowed");

  $.validator.addMethod("longaddress", function(value, element) {
      return this.optional(element) || /^[a-zA-Z0-9\s\.,#-/=_@]+$/.test(value);
  }, "Only address allowed");

  $.validator.addMethod("imageFileType", function(value, element) {
      return this.optional(element) || /^.*\.(jpg|jpeg|png)$/i.test(value);
  }, "Please select a valid JPG or PNG or JPEG image file.");




    $("#lesson_create_form").validate({
      rules: {
        sub_category_name: {
          required:true

        },
        course_name: {
          required: true,

        },
        specialization_name:{
          required:true
        },
        chapter_name:{

          required: true,
      
        },
        lesson_title:{
          required: true,
          noDoubleSpace: true,
          minlength: 3,
          maxlength: 80,
          alphanumeric: true,
        },
        lesson_logo:{
          imageFileType: true,
          required: true,
          
        },
        lesson_image:{
          imageFileType: true,
          required:true,
        },
        short_description:{
          required:true,
          minlength: 20,
          maxlength: 200,
          noDoubleSpace: true,
        }

      },
      messages: {
        sub_category_name: {
          required:"Please Select Sub Category"
        },
        course_name: {
          required: "Please Select Course Name",

        },
        specialization_name:{
          required:"Please Select Specialization Name"
        },
        chapter_name:{

          required: "Please Select Chapter Name",
        },
        lesson_title:{
          required: "Please Enter Lesson Title",
          minlength: "Minimum of 3 characters",
          maxlength: "Maximum of 80 characters",

        },
        lesson_logo:{
          required: "Please Select Lesson Logo",
        },
        lesson_image:{
          required: "Please Select Lesson Image",
        },
        short_description:{
          required: "Please Enter Short Description",
          minlength: "Minimum of 20 characters",
          maxlength: "Maximum of 200 characters",
        }


      },
      submitHandler: function (form) {
        form.submit();
      },
    });
    $(".lesson_edit_form").each(function () {
      $(this).validate({
        rules: {
          sub_category_edit: {
            required:true
  
          },
          course_name_edit: {
            required: true,
  
          },
          specialization_edit:{
            required:true
          },
          chapter_name_edit:{
  
            required: true,
        
          },
          lesson_title_edit:{
            required: true,
            noDoubleSpace: true,
            minlength: 3,
            maxlength: 80,
            alphanumeric: true,
          },
          lesson_logo_edit:{
            imageFileType: true,
            required: true,
            
          },
          lesson_image_edit:{
            imageFileType: true,
            required:true,
          },
          short_description_edit:{
            required:true,
            minlength: 20,
            maxlength: 200,
            noDoubleSpace: true,
          }
  
        },
        messages: {
          sub_category_edit: {
            required:"Please Select Sub Category"
          },
          course_name_edit: {
            required: "Please Select Course Name",
  
          },
          specialization_edit:{
            required:"Please Select Specialization Name"
          },
          chapter_name_edit:{
  
            required: "Please Select Chapter Name",
          },
          lesson_title_edit:{
            required: "Please Enter Lesson Title",
            minlength: "Minimum of 3 characters",
            maxlength: "Maximum of 80 characters",
  
          },
          lesson_logo_edit:{
            required: "Please Select Lesson Logo",
          },
          lesson_image_edit:{
            required: "Please Select Lesson Image",
          },
          short_description_edit:{
            required: "Please Enter Short Description",
            minlength: "Minimum of 20 characters",
            maxlength: "Maximum of 200 characters",
          }
        },
        submitHandler: function (form) {
          form.submit();
        },

      });
    });
  });
</script>

<script>
  function validateUploadForm(form) {
    $(form).find('#input-file-now').on('change', function () {
      var file = this.files[0];
      var fileExt = file.name.split('.').pop().toLowerCase();

      if (fileExt === 'csv') {
        $(form).find('button[type="submit"]').prop('disabled', false);
        $(form).find('#input-file-now').html('');
      } else {
        $(form).find('button[type="submit"]').prop('disabled', true);
        $(form).find('#csvPreview').html('<span style="color: red;">Only CSV files are allowed.</span>');
      }
    });

    $(form).on('submit', function (e) {
      var file = $(form).find('#input-file-now')[0].files[0];

      if (!file) {
        e.preventDefault();
        $(form).find('#csvPreview').html('<span style="color: red;">Please select a csv file.</span>');
      }
    });
  }

  $('#UploadSpecialization').on('shown.bs.modal', function () {
    validateUploadForm($(this).find('form'));
  });
</script>




<!---Delete Script-->
<script>
  // Function to update the "Select All" checkbox status
  function updateSelectAllCheckbox() {
    var selectAllCheckbox = document.getElementById('selectAll');
    var rowCheckboxes = document.querySelectorAll('.row-checkbox');
    var allChecked = true;

    rowCheckboxes.forEach(function (checkbox) {
      if (!checkbox.checked) {
        allChecked = false;
      }
    });

    selectAllCheckbox.checked = allChecked;
    updateSelectedRowsList(); // Update selected rows list when "Select All" checkbox is clicked
  }

  // Function to update the selected rows list and toggle delete button visibility
  function updateSelectedRowsList() {
    var selectedRowsList = document.getElementById('selectedRowsList');
    var selectedIdsInput = document.getElementById('selected_ids_input');
    var deleteButton = document.getElementById('deleteButton');

    var selectedRows = document.querySelectorAll('.row-checkbox:checked');
    var selectedCount = selectedRows.length;

    if (selectedCount > 1) {
      deleteButton.style.display = 'block'; // Show delete button if more than one row is selected
    } else {
      deleteButton.style.display = 'none'; // Hide delete button if only one row or none is selected
    }

    var selectedIds = [];
    selectedRows.forEach(function (row) {
      var courseId = row.dataset.courseId;
      selectedIds.push(courseId);
    });

    // Set the value of the hidden input field to the selected IDs
    selectedIdsInput.value = selectedIds.join(',');

    // Update the delete modal message with the selected count
    document.getElementById('deleteMessage').textContent = "Are you sure you want to delete " + selectedCount + " records?";
  }

  // Event listener for checkbox change
  document.querySelectorAll('.row-checkbox').forEach(function (checkbox) {
    checkbox.addEventListener('change', function () {
      updateSelectedRowsList();
      updateSelectAllCheckbox();
    });
  });

  // Event listener for select all checkbox change
  document.getElementById('selectAll').addEventListener('change', function () {
    var isChecked = this.checked;
    document.querySelectorAll('.row-checkbox').forEach(function (checkbox) {
      checkbox.checked = isChecked;
    });
    updateSelectedRowsList();
  });

  // Initially update delete button visibility
  updateSelectedRowsList();

  // Event listener for delete button click
  document.getElementById('confirmDelete').addEventListener('click', function () {
    // Perform delete action here
    // For now, let's just close the modal
    $('#deleteModal').modal('hide');
  });
</script>


<script>
  $(document).ready(function(){
    $('.chapter-select').change(function(){
      var chapter_id = $(this).val();
      var specializationSelect = $(".specialization-select");
      var courseSelect = $('.course-select');
      var subCategorySelect = $('.sub-category-select'); 
      specializationSelect.empty().append('<option value="">Select Specialization</option>');
      courseSelect.empty().append('<option value="">Select Course</option>');
      subCategorySelect.empty().append('<option value="">Select Sub Category</option>');
      if (chapter_id){
        $.getJSON('/get_specializations_ch/'+ chapter_id,function(data){
          $.each(data,function(index,specialization){
            specializationSelect.append('<option value="' + specialization.id + '">' + specialization.name + '</option>')
          })
        }).fail(function(jqxhr,textStatus,error){
          console.error('Error fetching specialization',textStatus,error);
        })
      }
    })

    $(".specialization-select").change(function() {
      var specializationId = $(this).val();
      console.warn(specializationId);
      var courseSelect = $('.course-select');
      var subCategorySelect = $('.sub-category-select');
      courseSelect.empty().append('<option value="">Select Course</option>');
      subCategorySelect.empty().append('<option value="">Select Sub Category</option>');

      if (specializationId) {
        $.getJSON('/get_courses_for_ch/' + specializationId, function(data) {
          $.each(data, function(index, course) {
            courseSelect.append('<option value="' + course.id + '">' + course.course_name + '</option>');
          });
        }).fail(function(jqxhr, textStatus, error) {
          console.error('Error fetching courses:', textStatus, error);
        });
      }
})

//
$('.course-select').change(function() {
  var courseId = $(this).val();
  console.warn(courseId);
  var subcatSelect = $('.sub-category-select');
  subcatSelect.empty().append('<option value="">Select Sub Category</option>');
  
  if (courseId) {
    $.getJSON('/get_sub_categories/' + courseId, function(data) {
      $.each(data, function(index, subCat) {
        subcatSelect.append('<option value="' + subCat.id + '">' + subCat.sub_cat_title + '</option>');
      });
    }).fail(function(jqxhr, textStatus, error) {
      console.error('Error fetching subcategories:', textStatus, error);
    });
  }
});

  })
</script>


{% endblock %} 